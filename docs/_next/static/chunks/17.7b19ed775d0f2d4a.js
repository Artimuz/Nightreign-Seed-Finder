"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[17,871],{3871:(e,t,r)=>{r.d(t,{AM:()=>m,Pi:()=>u,getInteractiveCoordinates:()=>x,ks:()=>g,oM:()=>y,uG:()=>p});let l=e=>(null!=e?e:"").toLowerCase().replace(/\s+/g,"").replace(",",""),n=[{id:"1",x:400,y:180},{id:"2",x:710,y:210},{id:"3",x:535,y:225},{id:"4",x:232,y:281},{id:"5",x:628,y:293},{id:"6",x:412,y:303},{id:"7",x:776,y:361},{id:"8",x:217,y:354},{id:"9",x:693,y:370},{id:"10",x:357,y:395},{id:"11",x:580,y:430},{id:"12",x:774,y:425},{id:"13",x:282,y:447},{id:"14",x:663,y:465},{id:"15",x:318,y:550},{id:"16",x:205,y:555},{id:"17",x:804,y:576},{id:"18",x:629,y:585},{id:"19",x:550,y:630},{id:"20",x:753,y:631},{id:"21",x:276,y:650},{id:"22",x:610,y:690},{id:"23",x:452,y:695},{id:"24",x:199,y:710},{id:"25",x:745,y:740},{id:"26",x:400,y:780},{id:"27",x:566,y:795}],a=[{id:"1",x:347,y:312},{id:"2",x:733,y:347},{id:"3",x:770,y:414},{id:"4",x:612,y:512},{id:"5",x:353,y:525},{id:"6",x:253,y:579},{id:"7",x:641,y:655},{id:"8",x:280,y:683},{id:"9",x:361,y:773},{id:"10",x:453,y:779},{id:"11",x:921,y:806},{id:"12",x:881,y:898},{id:"13",x:685,y:931},{id:"14",x:397,y:390},{id:"15",x:723,y:475},{id:"16",x:436,y:551},{id:"17",x:319,y:636},{id:"18",x:362,y:741},{id:"19",x:893,y:816},{id:"20",x:811,y:908}],o=[{id:"1",x:451,y:326},{id:"2",x:705,y:348},{id:"3",x:531,y:439},{id:"4",x:370,y:449},{id:"5",x:639,y:471},{id:"6",x:727,y:472},{id:"7",x:418,y:480},{id:"8",x:265,y:482},{id:"9",x:453,y:580},{id:"10",x:294,y:591},{id:"11",x:237,y:613},{id:"12",x:401,y:613},{id:"13",x:512,y:667},{id:"14",x:357,y:749},{id:"15",x:419,y:793},{id:"16",x:713,y:523},{id:"17",x:667,y:603},{id:"18",x:765,y:624},{id:"19",x:615,y:667},{id:"20",x:763,y:741},{id:"21",x:625,y:743}],s={id:"nightlord",x:111,y:900},i={id:"nightlord_status_card",x:85,y:940},d={id:"event",x:900,y:900},c={id:"event",x:900,y:820},u=e=>"kevins78"===(null!=e?e:"").toLowerCase()?c:d,f=e=>"greathollow"===l(e)?a:n,y=e=>"greathollow"===l(e)?o:[],x=e=>[...f(e),s],g=()=>s,m=()=>i,p=(e,t)=>{let r=((e,t)=>{let r=t/1e3;return{x:e.x*r,y:e.y*r}})(e,t);return[t-r.y,r.x]};x(),[...f(void 0)]},8017:(e,t,r)=>{r.r(t),r.d(t,{default:()=>m});var l=r(5155),n=r(2115),a=r(7650),o=r(2360);function s(e){let{isOpen:t,onClose:r}=e,s=(0,n.useCallback)(e=>{t&&"Escape"===e.key&&r()},[t,r]),i=(0,n.useCallback)(e=>{e.target===e.currentTarget&&r()},[r]);if((0,n.useEffect)(()=>(t&&(document.addEventListener("keydown",s),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",s),document.body.style.overflow="unset"}),[s,t]),!t)return null;let d=(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",onClick:i,children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm"}),(0,l.jsxs)("div",{className:"relative w-full max-w-lg mx-4 rounded-lg shadow-2xl overflow-hidden flex flex-col bg-black/95 border border-gray-600/50",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-600/50 bg-black/80",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Crystal Finder Help"}),(0,l.jsx)("button",{onClick:r,className:"text-gray-300 hover:text-white text-xl px-2","aria-label":"Close modal",children:"\xd7"})]}),(0,l.jsxs)("div",{className:"p-4 space-y-5 max-h-[70vh] overflow-y-auto scrollbar-custom",children:[(0,l.jsx)("div",{className:"text-sm text-gray-200 leading-relaxed",children:"Left click a location to confirm a Crystal. Right click a location to confirm there is no Crystal there."}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("h3",{className:"text-white font-semibold",children:"Labeling"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 rounded-md border border-gray-700/60 bg-black/60 px-3 py-2",children:[(0,l.jsx)("img",{src:o.ZS.possibleCrystal,alt:"Possible Crystal",className:"w-14 h-14 object-contain",style:{filter:"drop-shadow(1px 0 0 #fff) drop-shadow(-1px 0 0 #fff) drop-shadow(0 1px 0 #fff) drop-shadow(0 -1px 0 #fff) drop-shadow(2px 2px 4px rgba(0,0,0,0.5))"}}),(0,l.jsx)("div",{className:"text-sm text-gray-200",children:"There is a chance you will find a Crystal in that location."})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 rounded-md border border-gray-700/60 bg-black/60 px-3 py-2",children:[(0,l.jsx)("img",{src:o.ZS.brokenCrystal,alt:"Confirmed Crystal",className:"w-14 h-14 object-contain",style:{filter:"drop-shadow(1px 0 0 #fff) drop-shadow(-1px 0 0 #fff) drop-shadow(0 1px 0 #fff) drop-shadow(0 -1px 0 #fff) drop-shadow(2px 2px 4px rgba(0,0,0,0.5))"}}),(0,l.jsx)("div",{className:"text-sm text-gray-200",children:"You already found or broke this Crystal."})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 rounded-md border border-gray-700/60 bg-black/60 px-3 py-2",children:[(0,l.jsx)("img",{src:o.ZS.Crystal,alt:"Guaranteed Crystal",className:"w-14 h-14 object-contain",style:{filter:"drop-shadow(1px 0 0 #fff) drop-shadow(-1px 0 0 #fff) drop-shadow(0 1px 0 #fff) drop-shadow(0 -1px 0 #fff) drop-shadow(2px 2px 4px rgba(0,0,0,0.5))"}}),(0,l.jsx)("div",{className:"text-sm text-gray-200",children:"There will be a guaranteed Crystal here."})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 rounded-md border border-gray-700/60 bg-black/60 px-3 py-2",children:[(0,l.jsx)("img",{src:o.ZS.CrystalUnder,alt:"Underground Crystal",className:"w-14 h-14 object-contain",style:{filter:"drop-shadow(1px 0 0 #fff) drop-shadow(-1px 0 0 #fff) drop-shadow(0 1px 0 #fff) drop-shadow(0 -1px 0 #fff) drop-shadow(2px 2px 4px rgba(0,0,0,0.5))"}}),(0,l.jsx)("div",{className:"text-sm text-gray-200",children:"The arrow indicates that the location is underground."})]})]})]})]})]})]});return(0,a.createPortal)(d,document.body)}var i=r(5027),d=r.n(i),c=r(9304);let u=e=>e.trim().toLowerCase().replace(/\s+/g," ").replace(/[^a-z0-9_ ]/g,"");var f=r(3871);let y={baseUrl:"https://thefifthmatt.github.io/nightreign/pattern/",fileExtension:"jpg",sourceLabel:"thefifthmatt"},x={baseUrl:"https://kevins78.github.io/nightreigndlcseeds/images/",fileExtension:"png",sourceLabel:"kevins78"},g=JSON.parse('[{"id":"1","slots":{"1":"Crystal","2":"","3":"","4":"Crystal","5":"Crystal","6":"","7":"","8":"","9":"","10":"Crystal","11":"","12":"CrystalUnder","13":"","14":"Crystal","15":"","16":"","17":"CrystalUnder","18":"","19":"CrystalUnder","20":"","21":""}},{"id":"2","slots":{"1":"","2":"Crystal","3":"","4":"Crystal","5":"","6":"","7":"","8":"Crystal","9":"Crystal","10":"","11":"","12":"","13":"","14":"Crystal","15":"","16":"CrystalUnder","17":"","18":"","19":"","20":"CrystalUnder","21":"CrystalUnder"}},{"id":"3","slots":{"1":"","2":"","3":"Crystal","4":"","5":"","6":"Crystal","7":"Crystal","8":"","9":"Crystal","10":"","11":"Crystal","12":"","13":"","14":"","15":"","16":"","17":"","18":"CrystalUnder","19":"","20":"CrystalUnder","21":"CrystalUnder"}},{"id":"4","slots":{"1":"","2":"","3":"","4":"","5":"Crystal","6":"","7":"Crystal","8":"Crystal","9":"","10":"","11":"","12":"CrystalUnder","13":"Crystal","14":"","15":"Crystal","16":"","17":"","18":"CrystalUnder","19":"CrystalUnder","20":"","21":""}}]');function m(e){let{seedNumber:t}=e,r=(0,n.useRef)(null),a=(0,n.useRef)(null),i=(0,n.useRef)(null),m=(0,n.useRef)(null),p=(0,n.useRef)(null),h=(0,n.useRef)(null),b=(0,n.useRef)(null),v=(0,n.useRef)(null),w=(0,n.useRef)(new Map),[C,U]=(0,n.useState)(!1),[k,S]=(0,n.useState)(null),[E,M]=(0,n.useState)(!1),[j,N]=(0,n.useState)(!1),[_,L]=(0,n.useState)(!1),[Z,I]=(0,n.useState)(()=>new Map),P=(0,n.useRef)(1e3);(0,n.useEffect)(()=>{let e=()=>{U(window.innerWidth<=768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,n.useEffect)(()=>{let e=(0,c.qW)().find(e=>e.seed_id===t);S(null!=e?e:null)},[t]);let z=(0,n.useMemo)(()=>{let e;return"greathollow"===(null!=(e=null==k?void 0:k.map_type)?e:"").toLowerCase().replace(/\s+/g,"").replace(",","")},[null==k?void 0:k.map_type]);(0,n.useEffect)(()=>{z||(M(!1),N(!1),L(!1),I(new Map))},[z]);let T=(0,n.useMemo)(()=>(e=>{if(!e)return null;let t=e.trim();if(!t)return null;if(t.match(/^(\d+_[A-Za-z0-9]+)$/)&&o.Dx.includes(t))return t;let r=u(t),l=o.Dx.find(e=>u(e)===r);if(l)return l;let n=o.Dx.find(e=>{var t;return u(null!=(t=o.SZ[e])?t:"")===r});if(n)return n;let a=r.split("_").filter(Boolean)[1];if(a){let e=o.Dx.find(e=>{var t;return u(null!=(t=o.SZ[e])?t:"")===a});if(e)return e}return null})(null==k?void 0:k.nightlord),[null==k?void 0:k.nightlord]),D=(0,n.useMemo)(()=>(function(e){let t=Number(e),r=Number.isFinite(t)&&t>=0&&t<=319?y:x;return{surfaceImageUrl:"".concat(r.baseUrl).concat(e,".").concat(r.fileExtension),undergroundImageUrl:"".concat(r.baseUrl).concat(e,"_under.").concat(r.fileExtension),sourceLabel:r.sourceLabel}})(t),[t]),H=(0,n.useMemo)(()=>"kevins78"===D.sourceLabel,[D.sourceLabel]),R=(0,n.useMemo)(()=>g.map(e=>({id:e.id,slots:new Map(Object.entries(e.slots))})),[]),O=(0,n.useMemo)(()=>{let e=Array.from(Z.entries()).filter(e=>{let[,t]=e;return"confirmed"===t}).map(e=>{let[t]=e;return t}),t=Array.from(Z.entries()).filter(e=>{let[,t]=e;return"cleared"===t}).map(e=>{let[t]=e;return t});return 0===e.length&&0===t.length?R:R.filter(r=>!!e.every(e=>{var t;let l=null!=(t=r.slots.get(e))?t:"";return"Crystal"===l||"CrystalUnder"===l})&&t.every(e=>{var t;let l=null!=(t=r.slots.get(e))?t:"";return"Crystal"!==l&&"CrystalUnder"!==l}))},[R,Z]),A=(0,n.useMemo)(()=>{var e;return 1!==O.length?null:null!=(e=O[0])?e:null},[O]);(0,n.useEffect)(()=>{z&&(new Image().src=D.undergroundImageUrl)},[z,D.undergroundImageUrl]),(0,n.useEffect)(()=>{if(!r.current)return;let e=Math.min(r.current.offsetWidth,r.current.offsetHeight)||1e3;P.current=e;let t=[[0,0],[e,e]];a.current&&(a.current.remove(),a.current=null),i.current=null,m.current=null,p.current=null,h.current=null,b.current=null,v.current=null,w.current.forEach(e=>e.remove()),w.current=new Map;let l=d().map(r.current,{crs:d().CRS.Simple,...C?{minZoom:0,maxZoom:3}:{minZoom:0,maxZoom:2},zoomControl:!1,attributionControl:!1,zoomSnap:.1,zoomDelta:.1});if(z||d().imageOverlay(D.surfaceImageUrl,t).addTo(l),z){l.createPane("greatHollowSurfacePane"),l.createPane("greatHollowShadePane"),l.createPane("greatHollowUndergroundPane"),l.createPane("greatHollowCrystalPane");let e=l.getPane("greatHollowSurfacePane"),r=l.getPane("greatHollowShadePane"),n=l.getPane("greatHollowUndergroundPane"),a=l.getPane("greatHollowCrystalPane");e&&(e.style.zIndex="200"),r&&(r.style.zIndex="250"),n&&(n.style.zIndex="300"),a&&(a.style.zIndex="400"),d().imageOverlay(D.surfaceImageUrl,t,{pane:"greatHollowSurfacePane"}).addTo(l);let o=d().rectangle(t,{interactive:!1,stroke:!1,fill:!0,fillColor:"#000",fillOpacity:.8,pane:"greatHollowShadePane"}),s=d().imageOverlay(D.undergroundImageUrl,t,{pane:"greatHollowUndergroundPane"});v.current=o,b.current=s;let c=new(d()).Control({position:"topright"});c.onAdd=()=>{let e=d().DomUtil.create("div","leaflet-great-hollow-toggle"),t=d().DomUtil.create("button","leaflet-great-hollow-toggle__button",e);t.type="button",t.onclick=()=>{M(e=>!e)};let r=d().DomUtil.create("div","leaflet-great-hollow-toggle__group",e),l=d().DomUtil.create("button","leaflet-great-hollow-toggle__button",r);l.type="button",l.onclick=()=>{N(e=>!e)};let n=d().DomUtil.create("div","leaflet-great-hollow-toggle__children",r),a=d().DomUtil.create("button","leaflet-great-hollow-toggle__child-button",n);a.type="button",a.textContent="Help",a.onclick=()=>{L(!0)};let o=d().DomUtil.create("button","leaflet-great-hollow-toggle__child-button",n);return o.type="button",o.textContent="Reset",o.onclick=()=>{I(new Map),L(!1)},d().DomEvent.disableClickPropagation(e),d().DomEvent.disableScrollPropagation(e),i.current=t,m.current=l,p.current=a,h.current=o,e},c.addTo(l)}l.fitBounds(t),l.setMaxBounds(t);let n=l.getZoom(),s=()=>l.getZoomScale(l.getZoom(),n),c=()=>{if(!(null==k?void 0:k.Event))return null;let t=o.sV[k.Event];if(!t)return null;let r=Math.round(.128*e*s()),l=r/2;return d().divIcon({html:'<img src="'.concat(t,'" alt="').concat(k.Event,'" style="width: ').concat(r,"px; height: ").concat(r,'px; object-fit: contain; filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5));" />'),className:"event-icon",iconSize:[r,r],iconAnchor:[l,l]})},u=null,y=c();if(y){let t=(0,f.Pi)(D.sourceLabel),r=(0,f.uG)(t,e);(u=d().marker(r,{icon:y,interactive:!1})).addTo(l)}let x=(e,t)=>{if(t&&t in e)return e[t]},g=()=>{let t=x(o.ZR,T);if(!t)return null;let r=Math.round(4.5*Math.max(24,.04*e)*s()),l=Math.round(.72*r),n=Math.round(.12*r),a=Math.round(.18*l),i=[Math.round(r/2)-n,Math.round(l/2)+a];return d().divIcon({html:'<img src="'.concat(t,'" alt="').concat(T,'" style="width: ').concat(r,"px; height: ").concat(l,'px; object-fit: contain; filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5));" />'),className:"nightlord-status-card",iconSize:[r,l],iconAnchor:i})},U=()=>{let t=x(o.y,T);if(!t)return null;let r=Math.round(2.2*Math.max(24,.04*e)*s()),l=Math.round(r/2);return d().divIcon({html:'<img src="'.concat(t,'" alt="').concat(T,'" style="width: ').concat(r,"px; height: ").concat(r,'px; object-fit: contain; filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5));" />'),className:"nightlord-icon",iconSize:[r,r],iconAnchor:[l,l]})},S=null;if(H){let t=U();if(t){let r=(0,f.ks)(),n=(0,f.uG)(r,e);(S=d().marker(n,{icon:t,interactive:!1,bubblingMouseEvents:!1,zIndexOffset:500})).addTo(l)}}let E=null,j=g();if(j){let t=(0,f.AM)(),r=(0,f.uG)(t,e);(E=d().marker(r,{icon:j,interactive:!0,bubblingMouseEvents:!1,zIndexOffset:600})).addTo(l)}let _=null,Z=!1,R=e=>{Z=e;let t=null==E?void 0:E.getElement();t&&(e?t.classList.add("nightlord-status-card-hidden"):t.classList.remove("nightlord-status-card-hidden"))},O=()=>{let e=null==E?void 0:E.getElement();e&&(e.onmouseenter=()=>{_&&(window.clearTimeout(_),_=null),R(!1)},e.onmouseleave=()=>{R(!0)},R(Z))};return E&&(_&&window.clearTimeout(_),_=window.setTimeout(()=>{R(!0)},2e3),O()),l.on("zoom",()=>{if(l.panInsideBounds(t,{animate:!1}),S){let e=U();e&&S.setIcon(e)}if(E){let e=g();e&&(E.setIcon(e),O())}if(u){let e=c();e&&u.setIcon(e)}}),l.on("drag",()=>{l.panInsideBounds(t,{animate:!1})}),a.current=l,()=>{if(u&&(u.remove(),u=null),_&&(window.clearTimeout(_),_=null),E){let e=E.getElement();e&&(e.onmouseenter=null,e.onmouseleave=null),E.remove(),E=null}S&&(S.remove(),S=null),w.current.forEach(e=>e.remove()),w.current=new Map,a.current&&(a.current.remove(),a.current=null)}},[C,t,k,T,D.surfaceImageUrl,D.undergroundImageUrl,D.sourceLabel,H,z]),(0,n.useEffect)(()=>{j||L(!1);let e=a.current;if(!e)return;let t=b.current,r=v.current;if(!z||!t||!r)return;let l=e.getContainer(),n=e=>{j&&e.preventDefault()};l.addEventListener("contextmenu",n);let o=i.current;o&&(o.textContent=E?"Underground: ON":"Underground: OFF",E?o.classList.add("leaflet-great-hollow-toggle__button--active"):o.classList.remove("leaflet-great-hollow-toggle__button--active"));let s=m.current;s&&(s.textContent=j?"Crystal Finder: ON":"Crystal Finder: OFF",j?s.classList.add("leaflet-great-hollow-toggle__button--active"):s.classList.remove("leaflet-great-hollow-toggle__button--active"));let d=p.current,c=h.current;if(d&&c){let e=j?"flex":"none";d.style.display=e,c.style.display=e}return E?(e.hasLayer(r)||r.addTo(e),e.hasLayer(t)||t.addTo(e)):(e.hasLayer(t)&&t.removeFrom(e),e.hasLayer(r)&&r.removeFrom(e)),()=>{l.removeEventListener("contextmenu",n)}},[j,z,E]);let F=(e,t)=>{I(r=>{var l;if((null!=(l=r.get(e))?l:"unknown")===t)return r;let n=new Map(r);return n.set(e,t),n})};return(0,n.useEffect)(()=>{j&&A&&L(!1)},[j,A]),(0,n.useEffect)(()=>{let e=a.current;if(!e||!z)return;let t=(0,f.oM)(null==k?void 0:k.map_type),r=P.current;if(Array.from(w.current.keys()).forEach(e=>{var r;w.current.get(e)&&j&&t.some(t=>t.id===e)||(null==(r=w.current.get(e))||r.remove(),w.current.delete(e))}),!j)return;let l=Math.round(.05*r*1.4),n=Math.round(l/2),s=(e,t)=>{if(0===e.length)return{anySurface:!1,anyUnderground:!1,allSurface:!1,allUnderground:!1,anyCrystal:!1,allCrystal:!1};let r=!1,l=!1,n=!0,a=!0,o=!1,s=!0;return e.forEach(e=>{var i;let d=null!=(i=e.slots.get(t))?i:"",c="Crystal"===d,u="CrystalUnder"===d,f=c||u;r=r||c,l=l||u,o=o||f,n=n&&c,a=a&&u,s=s&&f}),{anySurface:r,anyUnderground:l,allSurface:n,allUnderground:a,anyCrystal:o,allCrystal:s}},i=e=>{var t,r;let l=null!=(t=Z.get(e))?t:"unknown";if(A){let t=null!=(r=A.slots.get(e))?r:"";return"Crystal"===t?"confirmed"===l?o.ZS.brokenCrystal:o.ZS.Crystal:"CrystalUnder"===t?"confirmed"===l?o.ZS.brokenCrystalUnder:o.ZS.CrystalUnder:null}if("cleared"===l){let t=s(R,e);return t.anyUnderground&&!t.anySurface?o.ZS.possibleCrystalUnder:o.ZS.possibleCrystal}let n=s(O,e),a=n.anyUnderground&&!n.anySurface;return"confirmed"===l?a?o.ZS.brokenCrystalUnder:o.ZS.brokenCrystal:n.allCrystal?n.allUnderground||a?o.ZS.CrystalUnder:o.ZS.Crystal:n.anyCrystal?a?o.ZS.possibleCrystalUnder:o.ZS.possibleCrystal:null};t.forEach(t=>{let a=w.current.get(t.id),s=(e=>{var t;let r=i(e);if(!r)return null;let a="cleared"!==(null!=(t=Z.get(e))?t:"unknown")||A?"":'<div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; font-weight: 900; color: #ff3b3b; font-size: '.concat(Math.round(.85*l),'px; line-height: 1; text-shadow: 1px 0 0 #000, -1px 0 0 #000, 0 1px 0 #000, 0 -1px 0 #000;">\xd7</div>');return d().divIcon({html:'<div style="position: relative; width: '.concat(l,"px; height: ").concat(l,'px;"><img src="').concat(r,'" alt="crystal" style="width: ').concat(l,"px; height: ").concat(l,'px; object-fit: contain; filter: drop-shadow(1px 0 0 #fff) drop-shadow(-1px 0 0 #fff) drop-shadow(0 1px 0 #fff) drop-shadow(0 -1px 0 #fff) drop-shadow(2px 2px 4px rgba(0,0,0,0.5));" />').concat(a,"</div>"),className:"crystal-icon",iconSize:[l,l],iconAnchor:[n,n]})})(t.id);if(!s){a&&(a.remove(),w.current.delete(t.id));return}let c=(0,f.uG)(t,r);if(a){a.setLatLng(c),a.setIcon(s);return}let u=d().marker(c,{icon:s,interactive:!0,bubblingMouseEvents:!1,pane:"greatHollowCrystalPane",zIndexOffset:800});u.on("click",()=>{F(t.id,"confirmed")}),u.on("contextmenu",e=>{var r;let l=e.originalEvent;if(l instanceof MouseEvent&&(l.preventDefault(),l.stopPropagation()),A||"unknown"!==(null!=(r=Z.get(t.id))?r:"unknown"))return;let n=i(t.id);(n===o.ZS.possibleCrystal||n===o.ZS.possibleCrystalUnder)&&F(t.id,"cleared")}),u.addTo(e),w.current.set(t.id,u)})},[j,z,R,O,A,null==k?void 0:k.map_type,Z]),(0,n.useEffect)(()=>{if(!r.current)return;let e=new ResizeObserver(()=>{r.current&&(P.current=Math.min(r.current.offsetWidth,r.current.offsetHeight)||1e3,a.current&&setTimeout(()=>{var e;null==(e=a.current)||e.invalidateSize()},100))});return e.observe(r.current),()=>{e.disconnect()}},[]),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{ref:r,className:"overflow-hidden",style:{height:"calc(100vh - 160px)",width:"min(100vw, calc(100vh - 160px))",aspectRatio:"1",touchAction:"none",background:"transparent"}}),(0,l.jsxs)("div",{className:"absolute top-2 left-2 bg-black bg-opacity-70 text-white px-2 py-1 rounded text-sm font-medium pointer-events-none z-[1000] mapresult-seed-label",style:{fontSize:C?"12px":"14px"},children:["Map Pattern ",t," - Source: ",D.sourceLabel]}),(0,l.jsx)(s,{isOpen:z&&j&&_,onClose:()=>L(!1)})]})}}}]);